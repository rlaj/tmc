/*! events_core - v1.1.4 - 2017-04-05 */

/*
	Source: build/EventsCore.js
*/
!function($){function EventsCore(){var api=new Object,self=this;return this.core={version:"1.1.4",initialized:!1,loglevel:""},this.json={},this.view={},this.model={},this.collection={},this.service={},this.constants={MINIMUM_REFRESH_TIME_S:4},api.start=function(){self.core.initialized=!0,this.util.updateParams(),void 0!=this.util.getUrlParam("loglevel")&&(self.core.loglevel=this.util.getUrlParam("loglevel"));var logger=new this.util.Logger("EventsCore");logger.info("start - version:%s ll:%o",self.core.version,self.core.loglevel)},api.setLogLevel=function(level){self.core.loglevel=level,this.util.urlParams.loglevel&&(self.core.loglevel=this.util.urlParams.loglevel)},api.getLogLevel=function(){return self.core.loglevel},api.getVersion=function(){return self.core.version},api}window.eventsCore=new EventsCore}(jQuery),function($,eventsCore){"use strict";function EventsUtil(){var self=this,api=new Object;this.urlParams={},this.hashParams={};var processParams=function(){var match,group,query,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},queries={hash:"hashParams",search:"urlParams"};for(group in queries)for(query=window.location[group].substring(1);match=search.exec(query);)self[queries[group]][decode(match[1])]=decode(match[2])},get=function(type,key,default_){null==default_&&(default_=null);var value=this[type][key];return null==value&&(value=default_),value}.bind(this);return api.urlParams=self.urlParams,api.hashParams=self.hashParams,api.getUrlParam=function(key,default_){return get("urlParams",key,default_)},api.getHashParam=function(key,default_){return get("hashParams",key,default_)},api.updateParams=function(){self.urlParams={},self.hashParams={},processParams()},api.updateParams(),api.Logger=Logger,api}function Logger(prefix){var prefix=prefix||"Events",api=new Object,loglevel="",putLog=function(type,passedArguments){var args=Array.prototype.slice.call(passedArguments);args[0]="["+prefix+"] "+args[0],args.join(","),loglevel=eventsCore.getLogLevel(),"function"==typeof console[type]&&(loglevel.indexOf(type)>-1||loglevel.indexOf("all")>-1)&&console[type].apply(console,args)};return api.info=function(){putLog("info",arguments)},api.out=function(){putLog("log",arguments)},api.debug=function(){putLog("debug",arguments)},api.warn=function(){putLog("warn",arguments)},api.error=function(){putLog("error",arguments)},api}eventsCore.util=new EventsUtil}(jQuery,window.eventsCore);;

/*
	Source: build/EventsDataLoader.js
*/
!function($,eventsCore){"use strict";function Poller(_id){var sources,interval,finalCallback,store,pollerInterval,id=_id?"Poller-"+_id:"Poller",logger=new eventsCore.util.Logger(id),api=new Object,active=!1,minimumRefresh=4e3,retryTimes=2,feeds={},metadata={cycle:0,lastUpdate:!1,paused:!0,items:0,fails:0};api.getId=function(){return id},api.getActive=function(){return active},api.add=function(_sources,_interval,_finalCallback,_store){active=!0,_interval>=0?interval=minimumRefresh>_interval?minimumRefresh:_interval:(interval=-1,metadata.paused=!0),sources=_sources||{},finalCallback=_finalCallback||!1,feeds={},store=_store||!1,pollerInterval=null,_.each(sources,function(callback,feed){feeds[feed]=callback,metadata.items++}),logger.info("add - feeds:%o interval2:%s",feeds,interval),_.isEmpty(feeds)?logger.warn("error adding feeds - interval:%s feeds:%o",interval,feeds):api.resume()},api.register=function(feed,cb){if(feed=feed||"",feeds[feed])throw new Error("This feed is already registered on this Poller instance.");if("http"!==feed.substr(0,4))throw new Error("Path must begin with http (ie. be a fully-fledged URL)");feeds[feed]=cb,1===feeds.length&&interval>FALCON_MIN_POLLING_INTERVAL&&resume()},api.unregister=function(feed,purgeData){purgeData=purgeData||!1,feed="string"==typeof feed?feed:"",feeds[feed]&&(delete feeds[feed],logger.info("Feed detached - %o",feed),purgeData===!0&&eventsCore.json[store]&&eventsCore.json[store][feed]&&delete eventsCore.json[store][feed])},api.pause=function(){metadata.paused===!1&&pollerInterval&&(clearInterval(pollerInterval),metadata.paused=!0)},api.resume=function(){metadata.paused===!0&&(metadata.paused=!1,load())},api.setFinalCallback=function(cb){"function"==typeof cb&&(finalCallback=cb)};var setNextPoll=function(overrideInterval){if(-1!=interval){var milliseconds=overrideInterval&&overrideInterval>=minimumRefresh?overrideInterval:interval;pollerInterval=setTimeout(function(){load()},milliseconds)}},load=function(){var main,promises=[];metadata.paused!==!0&&(_.each(feeds,function(providedCallback,feed){promises.push($.ajax({dataType:"json",url:feed}).done(function(data){var callback="function"==typeof providedCallback?providedCallback:_.noop;store&&(eventsCore.json[store]||(eventsCore.json[store]={}),eventsCore.json[store][feed]=data),metadata.fails=0,callback(data)}).fail(function(data){metadata.fails++,metadata.fails<=retryTimes&&interval>-1?(logger.info("load - failed feed:%s nextTry:%s",feed,metadata.fails*interval*2),setNextPoll(metadata.fails*interval*2)):metadata.paused=!0}))}),main=$.when.apply(this,promises),main.then(function(){var args=Array.prototype.slice.call(arguments);metadata.lastUpdate=Math.round(Date.now()/1e3),metadata.cycle++,"function"==typeof finalCallback&&finalCallback(args),setNextPoll()}))};return api}eventsCore.Poller=Poller}(jQuery,window.eventsCore);
//# sourceMappingURL=eventsCore-min.js.map;
define("eventsCore", ["jquery"], function(){});

